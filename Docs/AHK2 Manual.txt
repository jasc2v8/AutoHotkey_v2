Auto Hotkey Version 2 Manual

	Result is true: Non-zero e.g. 1 or -1
	Result is false: 0
	Result is true: string
	Result is false: ''
	
	Windows Exit Code (ErrorLevel) (AHK A_LastError)
	0=Success, Non-Zero=Fail
	
Array, Map

    MyArray := Array() ; not brackets!
	or
	MyArray := ["item1", "item2", "item3"]
    MyArray.Push("Item4") 
	value := MyArray[1] ; not parenthesis!
	
	myMap := Map()
	or
	MyMap := Map("Key1", "Value1", "Key2", "Value2", "Key3", "Value3")
	myMap.Set("Key1", "Value1")
	value := MyMap["Key1"]
	boolean := MyMap.Has("Key")
	
Button
	MyButton.OnEvent("Click", Button_Click()
	MyGui.AddButton(,"Default &OK").OnEvent("Click", (*)=>ExitApp)
		Button_Click(Ctrl, Info){}
	Button_Click(*){}

Colors
	Red: FF0000
	Green: 008000
	Blue: 0000FF
	Yellow: FFFF00
	Purple: 800080
	Fuchsia: FF00FF
	Cyan: 00FFFF
	White: FFFFFF
	Black: 000000 

You can also use custom RGB values like "c0xFFDD99" or "Background0x333333".

Compiler directives
	#Warn Unreachable
	#Warn Unreachable, Off
	;@Ahk2Exe-ConsoleApp
	
DEBUG
	OutputDebug "The value of a variable is: " . myVariable

Edit Control
	MyGui.Show()
	PostMessage(EM_SETSEL:=0xB1, -1, 0, MyEdit.Hwnd) ; Deselect all text

Fat Arrow Functions
	; from TextControlCustom
	
	GetColor() => this.ctrl.FontColor

    SetColor(color) => (
        this.FontColor := color,
        this.ctrl.SetFont("c" color)
    )

FileSelect
    file := FileSelect(, DefaultSoundFile, "Select Sound File", "Sound Files (*.wav;*.mp3;*.ogg;*.flac)")
    
	MyEdit.Text := (file !='') ? file : nop := true
	
    if (file !='') {
        MyEdit.Text := file
    }

FOCUS on a Button
	MyGui := Gui()
	Button1 := MyGui.Add("Button", "xm", "OK")
	MyGui.Show()
	ControlFocus("OK", MyGui)

Format()
	Format("{:02}", A_Index) 01, 02, 03...

GetObjectName

	MsgBox '[' GetObjectName(StrLen) ']'

    objName := GetObjectName(StrLen)
	MsgBox '[' objName ']' "StrLen"

    objName := GetObjectName(MyFunction)
	MsgBox '[' objName ']' ; "MyFunction"

	GetObjectName(obj) {
		return obj.Name
	}

	
GUID
	/**
	 *  Setting a GUID in Inno Setup is crucial for ensuring a 
	 * consistent and unique identity for your application across
	 * different versions. The GUID (Globally Unique Identifier)
	 * is used by the Windows operating system to track your application for
	 * uninstallation and updates.
	 * 
	 *  In Inno Setup, the GUID is defined using the AppId directive
	 * in the [Setup] section of your script. You should always set a 
	 * unique GUID for your application and keep it consistent for all
	 * future installer versions. This prevents the installer from 
	 * creating multiple uninstall entries and ensures updates work correctly.
	 * 
	 *  ;@Inno-AppId is a custom directive that is ignored by
	 * the Ahk2exe compiler. This application reads this value and writes it to
	 * the ISS Template you select.
	 */
	
Gui Add
	ButtonOK := g.Add("Button", "Default", "OK")	; ButtonOK is returned as a CtrlObj
	ButtonOK := g.AddButton("Default", "OK")		;  ButtonO

static AirSuperiorityBlue   := "72A0C1"
	MyGui.BackColor := "72A0C1" ; AirSuperiorityBlue
	
	;MyGui.BackColor := "4682B4" ; Steel Blue
	;MyGui.BackColor := StrReplace("6B9BC2", "#") ; Steel Blue Light
	;MyGui.BackColor := StrReplace("517FBF", "#") ; Steel Blue 5% lighter (ChatGPT)
	;MyGui.BackColor := StrReplace("5888B9", "#") ; Steel Blue 10% lighter (ChatGPT)
MyGui.BackColor := StrReplace("628FBE", "#") ; Steel Blue 15% lighter (ChatGPT)
	;MyGui.BackColor := StrReplace("6B9BC3", "#") ; Steel Blue 20% lighter (ChatGPT)
	;MyGui.BackColor := StrReplace("74A1C7", "#") ; Steel Blue 25% lighter (ChatGPT)

	MyGui.AddEdit('xm w410 h20 Center Backgroundeffeaa7', SyncBackSelectedProfile) ; #ffeaa7 Sour Lemon (flatuicolors)
	
Gui X,Y,W,H
	SUMMARY:
		BENEATH:	Xn or XM Beneath all previous controls (maximum Y extent plus margin). 
		RIGHT:		YP or YP+0 To the right of the previous control (right edge plus margin). 
			
		Specified X, Default for Y
		Xn or XM Beneath all previous controls (maximum Y extent plus margin). 
		XS Beneath all previous controls since the most recent use of the Section option. 
		X+n or XP+nonzero Same as the previous control's top edge (YP). 
		XP or XP+0 Below the previous control (bottom edge plus margin). 

		Specified Y, 	Default for X
		Yn or YM To the right of all previous controls (maximum X extent plus margin). 
		YS To the right of all previous controls since the most recent use of the Section option. 
		Y+n or YP+nonzero Same as the previous control's left edge (XP). 
		YP or YP+0 To the right of the previous control (right edge plus margin). 

		Add Horizontal Line
		MyDivider := MyGui.Add("Text", "xm w440 h1 0x10 Border vDivider") ; 0x10=SS_ETCHEDHORZ
		Border = Thick line, -Border = Thin line
	
	Dimensions (Examples\GuiAndClientMetricsExample.ahk)
		Gui("w400 h300") creates a Gui 416x339 and Client 400x300
		Inside the Gui is the Client area for the Gui Controls 400x300
		Top Border			=    8
		Title Bar 				=  23
		BorderY				=    8
		Client Width 		=	292
		Bottom Border	=   8
		---------------------------
		Gui Height			=  339 (match Gui above)
		
		Left Border=8 + Client width=400 + Right Border=8 = 416 (match Gui above)

Gui_Size(thisGui, MinMax, Width, Height) {
    if (MinMax = -1) 
        return
    Anchor([ScriptEdit, MyGui["Divider"]], "w")
    Anchor([MyGui["Browse"], MyGui["Merge"], MyGui["Cancel"]], "x")
}

Hex
	dec := 4095
	hex := "0x" Format("{:X}", dec)
	MsgBox hex   ; "0xFFF"

Hotkeys
	Symbol	Key	Full Key Name (in braces)	Example	Result
	^	Ctrl (Control)	{Ctrl}	Send("^a")	Presses Ctrl+A
	!	Alt (Alternate)	{Alt}	Send("!f")	Presses Alt+F
	+	Shift	{Shift}	Send("+a")	Presses Shift+A (sends an uppercase 'A')
	#	Win (Windows Key)	{LWin}, {RWin}	Send("#e")	Presses Win+E (opens File Explorer)

	Escape::ExitApp()

INSTALLATION
	Download and install AutoHotkey_2.0.19_setup.exe

	AutoHotkey Dash: Editor Settings, Editors with AHK support,
	Download and install SciTE4AutoHotkey, set as default

	AutoHotkey Dash: Compile, download and install Ahk2Exe, base file: Ahk2Exe

	Explorer context menu not configured - why?

Iterate
        MyArray := ["item1", "item2", "item3"]
        MyCSV := "apple, banana, cherry"
        MyLine := "The quick brown fox.`r`nJumps over the lazy dog.`r`nThe rain in Spain.`r`n"
        MyMap := Map("Key1", "Value1", "Key2", "Value2")
        MyObj := {KeyA: "ValueA", KeyB: "ValueB", KeyC: "ValueC"}

        MsgBox Type(MyArray), "Array"
        MsgBox Type(MyCSV), "CSV String"
        MsgBox Type(MyLine), "String"
        MsgBox Type(MyMap), "Map"
        MsgBox Type(MyObj), "Object"
		
        for key, value in myObj.OwnProps()
            MsgBox key ": " value, "Object"

        for value in MyArray
            MsgBox("Index: " A_Index ", Value: " value, "Array")

        ItemArray := StrSplit(MyCSV, ",")
        for index, item in ItemArray
            MsgBox("Index " index ": " item, "CSV String")

        ItemArray := StrSplit(MyLine, "`r`n")
        for index, item in ItemArray {
            if (item)
                MsgBox("Index " index ": " item, "Line String")

        for key, value in MyMap
            MsgBox("Key: " key ", Value: " value, "Map")

Common A_ Variables

	A_AhkPath: The full path of the AutoHotkey executable that is running the script.
	A_AppData: The full path of the current user's AppData\Roaming folder.
	A_AppDataCommon: The full path of the all-users AppData\Roaming folder.
	A_ComputerName: The computer's network name.
	A_ComSpec: The full path of the Command Prompt executable (cmd.exe).
	A_Cursor: The current shape of the mouse cursor (e.g., Arrow, IBeam).
	A_Desktop: The full path of the current user's Desktop folder.
	A_IsAdmin: A boolean value that is true if the script is running as an administrator, and false otherwise.
	A_IsCompiled: A boolean value that is true if the script is running from a compiled executable.
	A_Language: The language of the operating system (e.g., English).
	A_MyDocuments: The full path of the current user's My Documents folder.
	A_OSVersion: The version of the operating system (e.g., 10.0.19045 for Windows 10/11).
	A_ProgramFiles: The full path of the standard Program Files directory.
	A_ScriptDir: The directory where the currently executing script is located.
	A_ScriptFullPath: The full path and filename of the currently executing script.
	A_ScreenWidth: The width of the primary monitor in pixels.
	A_ScreenHeight: The height of the primary monitor in pixels.
	A_UserName: The name of the user who is logged on.
	A_WorkingDir: The current working directory of the script.

Notepad++
	Find in files, Filters
	*.ahk !+\.his* 			; search *.ahk, exclude .his* (.his, .history, etc.)
	*.ahk !+\.history		; search *.ahk, exclude .history
	*.ahk !\.history		; inop	

Prototype
	from: QuickerAccess.ahk
	
	Array.Prototype.Join := ArrayJoin
	
	Config["AddressList"].Join("`n")
	
	ArrayJoin(ArrayObj, Delim:=",") {
	Str := ""
    For Index, Value in ArrayObj
        Str .= Delim . Value
    Return SubStr(Str, StrLen(Delim)+1)
	}

	StringTrim(this, OmitChars:="") {
		return Trim(this, OmitChars)
	}
	String.Prototype.DefineProp("Trim", {Call: StringTrim})
	DefProp( "".base, "Trim", { Call: StringTrim } )
	
	From: C:\Users\Jim\Downloads\AHK-v2-libraries-main\AHK-v2-libraries-main
   JavaHome => (this.DefineProp("JavaHome", {value:RegRead("HKLM\SOFTWARE" (A_PtrSize = 8 ? "\Wow6432Node" : "") "\JavaSoft\Java Runtime Environment\" this.JavaVersion, "JavaHome", "")}), this.JavaHome)

	
SetTitleMatchMode MatchMode
	1: A window's title must start with the specified WinTitle to be a match.
	2: Default behavior. A window's title can contain WinTitle anywhere inside it to be a match.
	3: A window's title must exactly match WinTitle to be a match.

SoundBeep(523, 150) ; default frequency, milliseconds

Switch
    switch valType, 0
        case "String":
            return "'" val "'"
        case "Integer", "Float": ; implied OR
            return val
Time
	currentTime := FormatTime(A_Now, "HH:mm:ss")

TraySetIcon
	Window Icon: Set the Tray icon before creating the GUI; the window will inherit it
	To change the system tray icon in AHK v2, you use the TraySetIcon function.
	This changes both the icon you see in the taskbar (bottom right) and the default icon used for any GUIs you create later in the script.
	To set the icon immediately when the script starts, place this at the very top of your script:
	#Requires AutoHotkey v2+
	try TraySetIcon("shell32.dll", 44) ; Set tray icon to the Gold Star
	try TraySetIcon("dsuiext.dll", 36) ; Two cogs
	
TrayTip
	TrayTip "Text", "Title"
	SetTimer((*) => TrayTip(), -1000)
	
	SetTimer(HideTrayTip, -1000) 
	HideTrayTip() {
		TrayTip() ; Calling with no arguments clears the current notification
	}
	
Map
		Requires AutoHotkey v2.0

		; 1. Create a Map
		; You can create a map by calling Map() and passing key-value pairs.
		; The keys can be strings, numbers, or objects.
		MyMap := Map("apple", 1, "banana", 2, 3, "orange")

		; 2. Add or update contents
		; You can add new items or update existing ones using bracket notation.
		; Key and Value are separated by := for assignment.
		MyMap["grape"] := 4
		MyMap[5] := "kiwi"
		MyMap["apple"] := 10 ; Update existing key

		; 3. Access contents
		; You access values using bracket notation with the key inside.
		; The key can be a literal string (in quotes) or a variable.
		value1 := MyMap["banana"]  ; Access by string key
		value2 := MyMap[3]         ; Access by number key

		keyVar := "grape"
		value3 := MyMap[keyVar]    ; Access using a variable for the key

		; 4. Display contents
		MsgBox "Value for 'banana': " . value1
		MsgBox "Value for 3: " . value2
		MsgBox "Value for '" . keyVar . "': " . value3

		; 5. Iterate through the Map
		output := "Map Contents:`n"
		for key, value in MyMap
		{
			output .= key . " = " . value . "`n"
		}
		MsgBox output

MsgBox Defaults
	Screen	w=300, h=159
	Client		w=284, h=120
	Font 		s9, Segoe UI (Gui Default)

Font Defaults
		Gui:	s9, Segoe UI
		Edit	s8, Microsoft Sans Serif
		
MsgBox Defaults
	MsgBox():
		Window:		Screen 168x140, Client: 152x101
		Title:				A_ScriptName
		Text: 			Screen: 111x15, Client: 111x15
		ButtonOK:		75x23
		Line Split:		61 chars  msg := "1234567890123456789012345678901234567890123456789012345678901"
	
#
	
MsgBox Icons
	Icon	String Alias	Decimal Value	Hex Value	Description
	❌ Stop/Error	IconX	16	0x10	Typically a red circle with an 'X' (Error).
	❓ Question	Icon?	32	0x20	A question mark for user queries.
	⚠️ Exclamation	Icon!	48	0x30	A yellow triangle with an exclamation point (Warning).
	ℹ️ Asterisk	Iconi	64	0x40	A circle with an 'i' (Information).

 Include <script>
	The primary locations AutoHotkey checks for files when using the angle bracket syntax are:
	Local:		The Lib subfolder in the directory containing the main script file:	%A_ScriptDir%\Lib\
	User:		The Lib subfolder in the user's "My Documents" folder:					%A_MyDocuments%\AutoHotkey\Lib\
	Standard:	The Lib subfolder in the AutoHotkey installation directory:				C:\Program Files\AutoHotkey\Lib).
	ScriptDir:	The directory containing the main script file:									%A_ScriptDir%\

Return Code
	Result is true: Non-zero e.g. 1 or -1
	Result is false: 0
	Result is true: string
	Result is false: ''

Script Library Folders
	A_ScriptDir "\Lib\"  ; Local library.
	A_MyDocuments "\AutoHotkey\Lib\"  ; User library.
	"directory-of-the-currently-running-AutoHotkey.exe\Lib\"  ; Standard library.

Ternary
	var := x>y ? 2 : 3
	
WinExist("MyScript.ahk ahk_class AutoHotkey")

VSCode
	C:\Users\Jim\AppData\Local\Programs\Microsoft VS Code\Code.exe
	"%LOCALAPPDATA%\Programs\Microsoft VS Code\Code.exe"
	