BackupControlTool

BackupControlTool.ahk
	Gui controller
	Run AhkRunSkipUAC using Windows Task Scheduler

BackupControlWorker.ahk
	Run by AhkRunSkipUAC with elevated privileges
	Runs SyncBack with selected Profile
	Returns Output (none for SyncBack) to inform completed
	
AhkRunSkipUAC.ahk
	Triggered by BackupControlTool via Windows Task Scheduler
	Runs BackupControlWorker.ahk
	
Requires:
	BackupControlTool_Setup.ahk
		Install BackupControlWorker.exe in %PROGRAMDATA%
	BackupControlTool.ahk
		Controller
	AhkRunSkipUAC.ahk
		Scheduled Taskname = "AhkRunSkipUAC-Jim", runLevel = 'highest'
	SharedMemory.ahk
	IniHelper.ahk
	RunHelper.ahk

%PROGRAMDATA%\AutoHotkey\BackupControlTool\
	BackupControlWorker.exe
	BackupControlWorker.log


	
Admin NOT required:

Buttons:
[MonOff, Logoff, Standby, Shutdown
[X] Force

"TEST WITH SPACES"

-monoff
"~Backup JIM-PC folders to JIM-SERVER" -monoff
TEST -sleep
TEST -logoff

TEST -monoff

(either put the display off code in "AhkBackupSkipUAC - Jim", or add another action to run a program?)

Normal User Priv:
powershell -WindowStyle Hidden -Command "Add-Type -Name NativeMethods -Namespace Win32 -MemberDefinition '[DllImport(\"user32.dll\")]public static extern int SendMessage(int hWnd,int hMsg,int wParam,int lParam);'; [Win32.NativeMethods]::SendMessage(-1,0x0112,0xF170,2)"
AddArgsToTask

start Task

HOW TO GET OUTPUT OR KNOW WHEN TASK IS COMPLETE?\

if a param then turn display off

AhkBackupSkipUAC
	Get params - from where?
		YES: Clipboard?
		NO: AddArgsToTask? requires Admin to add args to a task wiht runLevel = 'highest'
		BackupArgs.dat?
	run SyncBack with params
	if param, turn display off
	
	



