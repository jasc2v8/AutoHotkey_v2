Use Case

Controller Launches Worker Elevated
	Controller.exe StartTask AdminLauncher, launches AdminLauncher.ahk
	AdminLauncher.Listen()
	Controller.exe Send Worker.exe and Params to AdminLauncher
	AdminLauncher.RunWait(Worker.exe Params)
	AdminLauncher.Send(reply)
	Controller.exe Receive()
	Controller.exe performs post-action


ABANDON
	Control and Worker both in the same Script (Avoids separate Control and Worker Scripts)
	Program.exe Start Task to Run Program.exe /worker and Params, Receive Reply from Program.exe / worker
	Example: Program.exe starts Task to run Program.exe /worker who runs a Backup Tool, then performs post-action (e.g. shutdown)

Control
	launcher := AdminLauncher()
	launcher.StartTask()
	launcher.Send(Control.ahk, /worker, Program.exe, Param1, ParamN )
	reply := launcher.Receive()

Task AdminLauncher runs AdminLauncher.ahk

AdminLauncher.ahk
	launcher:=AdminLauncher(this?)
	requestCSV:=this.Listen()
	RunShell(requestCSV)
	launcher.Send(ACK)
	
Control
	if A_Args
		RunAsWorker()
	Gui
	Submit
	
	RunAsWorker()
		launcher := AdminLauncher()
		commandCSV := RunShell.ArrayToCSV(A_Args)
		RunShell(commandCSV)
		PostActionl(commandCSV)


	
	
	
SIGNIFICANTLY SIMPLIFIED WITH INI FILE
ACK?
	SendMessage true/false?

Control.exe
	launcher := AdminLauncher()
	launcher.Wait()
	launcher.Receive()
	



	ini:=IniFile(A_Temp \ AdminLauncher.ini)
	ini.WriteSettings("COMMAND_CSV", "C:\Program Files\SyncBack.exe, Profile, Post-Action")
	launcher := AdminLauncher() ; auto StartTask() launcher.StartTask()
	
	launcher := AdminLauncher() 
	launcher.CommandArray:="C:\Program Files\SyncBack.exe, Profile, Post-Action"
	launcher.CommandCSV:="C:\Program Files\SyncBack.exe, Profile, Post-Action"
	launcher.CommandString:='"C:\Program Files\SyncBack.exe" Profile, Post-Action"'
	launcher.Start()
	launcher.Run(CommandCSV)
	
Task AdminLauncher starts AdminLauncher.ahk at runLevel='highest'

AdminLauncher.ahk
	commandCSV := ini.ReadSettings("COMMAND_CSV")
	RunShell(commandCSV)
	
A_Temp \AdminLauncher.ini
	[Settings]
	WINDOW_TITLE=BackupTool.ahk
	COMMAND_CSV=BackupTool.ahk /worker, SyncBack.exe, Profile, Post-Action
	RESULT=Blank=running, value (t/f/errorCode)
	
	AdminLauncher.ini
	+R=busy
	-R=ready
	
	

