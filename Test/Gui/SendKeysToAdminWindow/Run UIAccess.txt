Gemini

n AutoHotkey v2, the command Run("*UIAccess " A_ScriptFullPath") is a specialized way to launch your script with UIAccess (User Interface Accessibility) privileges. This is a specific Windows security status that allows a script to interact with windows that have elevated (Admin) permissions without requiring the script itself to run as a full Administrator.

Here is the breakdown of how it works and what each part does.

The Components
*UIAccess: This is a specific prefix (verb) used by the Run function. It tells Windows to bypass certain User Interface Privilege Isolation (UIPI) restrictions.

A_ScriptFullPath: This is a built-in variable that contains the absolute path to the script currently running.

The Space: Note the space inside the quotes after UIAccess. This ensures the command becomes *UIAccess C:\Path\To\Script.ahk.

Why use it?
Normally, a standard script cannot send keystrokes or mouse clicks to a window running as Administrator (like Task Manager or an installer). To fix this, you usually have two choices:

Run as Administrator: This gives the script full power but can be a security risk and causes UAC prompts.

Run with UIAccess: This allows the script to "talk" to elevated windows while remaining in a more restricted security context than a full Admin.

Requirements for it to work
For *UIAccess to function, specific conditions must be met:

The Executable: You must be using the UIA version of the AHK interpreter (e.g., AutoHotkey64_UIA.exe).

Installation: AutoHotkey must be installed in a trusted location (usually C:\Program Files\AutoHotkey).

Digital Signature: The executable must be digitally signed (the official AHK installer does this for the UIA files automatically).

Code Implementation
Following your specific formatting requirements (separating conditionals from returns and updating versioning), here is how you might implement a self-relaunching check at the top of a script:

AutoHotkey

; Version 1.0.1
; Ensure the script is running with UIAccess to interact with Admin windows

if !InStr(A_AhkPath, "_UIA.exe")
{
    try 
    {
        Run("*UIAccess " A_ScriptFullPath)
        ExitApp
    }
    catch
    {
        MsgBox("UIAccess failed. Please ensure AHK is installed in Program Files.")
    }
}

; Your script logic starts here
Note: If the script is already running via the UIA executable, InStr(A_AhkPath, "_UIA.exe") will be true, and it won't attempt to relaunch, preventing an infinite loop.
