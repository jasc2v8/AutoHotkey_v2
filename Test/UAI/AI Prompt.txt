ahk v2 what is uai.ahk


ahk v2 what is uai.ahk

In the context of AutoHotkey (AHK) v2, UIA.ahk (often referred to as the UIA-v2 library) is a powerful library used for UI Automation.

It is essentially a wrapper for Microsoft's UI Automation framework, which allows your scripts to "see" and interact with window elements that standard AHK commands (like ControlClick or ControlGetText) often cannot detect.

1. Why do people use it?
Standard AutoHotkey can easily interact with older "Win32" controls. However, many modern applications (like Chrome, Discord, Spotify, or Electron-based apps) don't use those standard controls. UIA.ahk allows you to:

Click buttons that don't have a standard "ClassNN" or ID.

Read text from specific areas of a webpage or app without using OCR (Optical Character Recognition).

Automate Browsers (Chrome, Edge, Firefox) much more reliably than by just sending keystrokes.

Find elements by their Name, AutomationID, or even their position in the "tree" (the hierarchy of elements in a window).

2. Who created it?
The v2 version is primarily maintained by a well-known community member named Descolada, based on earlier work by thqby. You can find the official repository on GitHub under Descolada/UIA-v2.

3. Key Components
UIA.ahk: The main library you #Include in your script to access automation functions.

UIA_Browser.ahk: A specialized extension of the library specifically designed to make automating web browsers (like getting URLs or switching tabs) much easier.

UIAViewer.ahk: A built-in tool (similar to AHK's "Window Spy") that you run to inspect a window. It shows you exactly what names or IDs you need to use in your code to target a specific button or text field.

Basic Example
If you wanted to click a button named "Submit" in a window that standard AHK can't see, the code would look something like this:

AutoHotkey
#Include UIA.ahk

; Get the element for the active window
el := UIA.ElementFromHandle("A")

; Find the button named "Submit" and click it
el.FindElement({Name: "Submit"}).Click()
Would you like me to show you how to set up the UIA Viewer so you can start inspecting windows on your PC?

yes

To get started with UIA-v2, the first thing you need is the UIAViewer. This tool is essential because it acts like an "X-ray" for software, showing you the hidden structure of modern apps.

1. Installation
Download the UIA-v2 library from the official GitHub repository.

Inside the downloaded folder, you will see a script named UIAViewer.ahk.

Run UIAViewer.ahk with AutoHotkey v2 installed.

2. Using the Viewer
Once the viewer is running, follow these steps to identify elements:

Hover and Capture: Move your mouse over the application you want to automate.

The Tree View: On the left side of the Viewer, you will see a hierarchical "tree." This represents how the program is built (e.g., Window > Pane > Group > Button).

Element Properties: On the right side, it will show specific attributes like:

Name: (e.g., "Submit")

AutomationId: (a unique ID set by the developer)

LocalizedControlType: (e.g., "button" or "edit")

3. Turning the Viewer into Code
One of the best features of Descolada's Viewer is that it can generate code for you.

Find the element you want to click in the Viewer.

Right-click that element in the tree list.

Select "Copy path to element" or "Copy Click code."

Paste that directly into your .ahk script.

A Simple Boilerplate Script
To use the library in your own project, make sure the UIA.ahk file is in the same folder as your script, then use this structure:

AutoHotkey
#Include UIA.ahk

; Press F2 to test automation on the active window
F2:: {
    try {
        ; 1. Connect to the active window
        AppEl := UIA.ElementFromHandle("A")
        
        ; 2. Find an element (Replace 'Name' with what you found in Viewer)
        Target := AppEl.FindElement({Name: "Settings", ControlType: "Button"})
        
        ; 3. Perform an action
        Target.Highlight() ; Briefly highlights the button so you know it found it
        Target.Click()
    } catch Error as e {
        MsgBox("Element not found: " . e.Message)
    }
}
Why use Highlight()?
When you are first learning UIA, I highly recommend using the .Highlight() method before .Click(). It draws a red box around the element on your screen, which is incredibly helpful for debugging to make sure your script is "looking" at the right thing.

Do you have a specific app or task in mind that you're trying to automate? I can help you write the specific FindElement logic for it.
